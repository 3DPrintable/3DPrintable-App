{"ast":null,"code":"import _asyncToGenerator from\"/Users/bryce_palichuk/Documents/GitHub/3DPrintable_Organization/3DPrintable-App/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/bryce_palichuk/Documents/GitHub/3DPrintable_Organization/3DPrintable-App/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/Users/bryce_palichuk/Documents/GitHub/3DPrintable_Organization/3DPrintable-App/node_modules/@babel/runtime/regenerator/index.js\";import React,{useState}from\"react\";import{useMoralisWeb3Api}from\"react-moralis\";import{Card,Image,Tooltip,Modal,Alert,Spin}from\"antd\";// Input, Button\nimport{useNFTBalance}from\"hooks/useNFTBalance\";import{FileSearchOutlined,DownloadOutlined}from\"@ant-design/icons\";import{useMoralisDapp}from\"providers/MoralisDappProvider/MoralisDappProvider\";import{getExplorer}from\"helpers/networks\";import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Meta=Card.Meta;var styles={NFTs:{display:\"flex\",flexWrap:\"wrap\",WebkitBoxPack:\"start\",justifyContent:\"flex-start\",margin:\"0 auto\",maxWidth:\"1000px\",gap:\"10px\"}};function NFTBalance(){var _useNFTBalance=useNFTBalance(),NFTBalance=_useNFTBalance.NFTBalance,fetchSuccess=_useNFTBalance.fetchSuccess;var _useMoralisDapp=useMoralisDapp(),chainId=_useMoralisDapp.chainId;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),visible=_useState2[0],setVisibility=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),nftToGrabFiles=_useState4[0],setNftToGrabFiles=_useState4[1];var Web3Api=useMoralisWeb3Api();var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),loading=_useState6[0],setLoading=_useState6[1];function fetchNFTMetadata(_x){return _fetchNFTMetadata.apply(this,arguments);}function _fetchNFTMetadata(){_fetchNFTMetadata=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(nft){var options,metaData,metadata,attributes,i,hash,name,ipfsHash,url,response,fileDownload;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);options={chain:chainId,address:nft.token_address,token_id:nft.token_id};_context.next=4;return Web3Api.token.getTokenIdMetadata(options);case 4:metaData=_context.sent;metadata=JSON.parse(metaData.metadata);attributes=metadata.attributes;i=0;case 8:if(!(i<attributes.length)){_context.next=36;break;}_context.prev=9;hash='';name='';name=attributes[i].value;hash=attributes[i].file;ipfsHash=hash.replace(\"ipfs://\",\"\");url=\"https://ipfs.moralis.io:2053/ipfs/\".concat(ipfsHash);_context.next=18;return fetch(url).then(function(r){return r.blob();});case 18:response=_context.sent;fileDownload=require('js-file-download');fileDownload(response,name+\".stl\");_context.next=29;break;case 23:_context.prev=23;_context.t0=_context[\"catch\"](9);console.log('fail');setLoading(false);failDownload();return _context.abrupt(\"break\",36);case 29:console.log('success');setLoading(false);setVisibility(false);succDownload();case 33:i++;_context.next=8;break;case 36:case\"end\":return _context.stop();}}},_callee,null,[[9,23]]);}));return _fetchNFTMetadata.apply(this,arguments);}function succDownload(){var secondsToGo=5;var modal=Modal.success({title:\"Success!\",content:\"Files succesfully downloaded\"});setTimeout(function(){modal.destroy();},secondsToGo*1000);}function failDownload(){var secondsToGo=5;var modal=Modal.error({title:\"Error!\",content:\"No files found!\"});setTimeout(function(){modal.destroy();},secondsToGo*1000);}var handleDownloadFileClick=function handleDownloadFileClick(nft){setNftToGrabFiles(nft);setVisibility(true);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{style:styles.NFTs,children:[!fetchSuccess&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Alert,{message:\"Unable to fetch all NFT metadata... We are searching for a solution, please try again later!\",type:\"warning\"}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:\"10px\"}})]}),NFTBalance&&NFTBalance.map(function(nft,index){return/*#__PURE__*/_jsx(Card,{hoverable:true,actions:[/*#__PURE__*/_jsx(Tooltip,{title:\"View Token on Block Explorer\",children:/*#__PURE__*/_jsx(FileSearchOutlined,{onClick:function onClick(){return window.open(\"\".concat(getExplorer(chainId),\"token/\").concat(nft.token_address),\"_blank\");}})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Download Files, if available\",children:/*#__PURE__*/_jsx(DownloadOutlined,{onClick:function onClick(){return handleDownloadFileClick(nft);}})})],style:{width:240,border:\"2px solid #e7eaf3\"},cover:/*#__PURE__*/_jsx(Image,{preview:false,src:(nft===null||nft===void 0?void 0:nft.image)||\"error\",fallback:\"data:image/png;base64,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\",alt:\"\",style:{height:\"240px\"}}),children:/*#__PURE__*/_jsx(Meta,{title:nft.name,description:nft.contract_type})},index);})]}),/*#__PURE__*/_jsxs(Modal,{title:\"Download \".concat(nftToGrabFiles===null||nftToGrabFiles===void 0?void 0:nftToGrabFiles.name,\" #\").concat(nftToGrabFiles===null||nftToGrabFiles===void 0?void 0:nftToGrabFiles.token_id,\" Files\"),visible:visible,okText:\"Download Files\",onOk:function onOk(){return fetchNFTMetadata(nftToGrabFiles);},onCancel:function onCancel(){return setVisibility(false);},children:[/*#__PURE__*/_jsx(\"p\",{children:\"Click Download Files to download the 3d printer files, if available!\"}),/*#__PURE__*/_jsx(Spin,{spinning:loading,children:/*#__PURE__*/_jsx(\"img\",{alt:\"NFT\",src:\"\".concat(nftToGrabFiles===null||nftToGrabFiles===void 0?void 0:nftToGrabFiles.image),style:{width:\"250px\",margin:\"auto\",borderRadius:\"10px\",marginTop:\"15px\",marginBottom:\"15px\"}})})]})]});}export default NFTBalance;","map":{"version":3,"sources":["/Users/bryce_palichuk/Documents/GitHub/3DPrintable_Organization/3DPrintable-App/src/components/NFTBalance.jsx"],"names":["React","useState","useMoralisWeb3Api","Card","Image","Tooltip","Modal","Alert","Spin","useNFTBalance","FileSearchOutlined","DownloadOutlined","useMoralisDapp","getExplorer","Meta","styles","NFTs","display","flexWrap","WebkitBoxPack","justifyContent","margin","maxWidth","gap","NFTBalance","fetchSuccess","chainId","visible","setVisibility","nftToGrabFiles","setNftToGrabFiles","Web3Api","loading","setLoading","fetchNFTMetadata","nft","options","chain","address","token_address","token_id","token","getTokenIdMetadata","metaData","metadata","JSON","parse","attributes","i","length","hash","name","value","file","ipfsHash","replace","url","fetch","then","r","blob","response","fileDownload","require","console","log","failDownload","succDownload","secondsToGo","modal","success","title","content","setTimeout","destroy","error","handleDownloadFileClick","marginBottom","map","index","window","open","width","border","image","height","contract_type","borderRadius","marginTop"],"mappings":"kfAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,iBAAT,KAAkC,eAAlC,CACA,OAASC,IAAT,CAAeC,KAAf,CAAsBC,OAAtB,CAA+BC,KAA/B,CAAsCC,KAAtC,CAA6CC,IAA7C,KAAyD,MAAzD,CAAiE;AACjE,OAASC,aAAT,KAA8B,qBAA9B,CACA,OAASC,kBAAT,CAA6BC,gBAA7B,KAAqD,mBAArD,CACA,OAASC,cAAT,KAA+B,mDAA/B,CACA,OAASC,WAAT,KAA4B,kBAA5B,C,6IAEA,GAAQC,CAAAA,IAAR,CAAiBX,IAAjB,CAAQW,IAAR,CAEA,GAAMC,CAAAA,MAAM,CAAG,CACbC,IAAI,CAAE,CACJC,OAAO,CAAE,MADL,CAEJC,QAAQ,CAAE,MAFN,CAGJC,aAAa,CAAE,OAHX,CAIJC,cAAc,CAAE,YAJZ,CAKJC,MAAM,CAAE,QALJ,CAMJC,QAAQ,CAAE,QANN,CAOJC,GAAG,CAAE,MAPD,CADO,CAAf,CAYA,QAASC,CAAAA,UAAT,EAAsB,CACpB,mBAAqCf,aAAa,EAAlD,CAAQe,UAAR,gBAAQA,UAAR,CAAoBC,YAApB,gBAAoBA,YAApB,CACA,oBAAoBb,cAAc,EAAlC,CAAQc,OAAR,iBAAQA,OAAR,CACA,cAAiCzB,QAAQ,CAAC,KAAD,CAAzC,wCAAO0B,OAAP,eAAgBC,aAAhB,eACA,eAA4C3B,QAAQ,CAAC,IAAD,CAApD,yCAAO4B,cAAP,eAAuBC,iBAAvB,eACA,GAAMC,CAAAA,OAAO,CAAG7B,iBAAiB,EAAjC,CACA,eAA8BD,QAAQ,CAAC,KAAD,CAAtC,yCAAO+B,OAAP,eAAgBC,UAAhB,eANoB,QAQLC,CAAAA,gBARK,4JAQpB,iBAAgCC,GAAhC,0MACEF,UAAU,CAAC,IAAD,CAAV,CACMG,OAFR,CAEkB,CACdC,KAAK,CAAEX,OADO,CAEdY,OAAO,CAAEH,GAAG,CAACI,aAFC,CAGdC,QAAQ,CAAEL,GAAG,CAACK,QAHA,CAFlB,uBAOyBT,CAAAA,OAAO,CAACU,KAAR,CAAcC,kBAAd,CAAiCN,OAAjC,CAPzB,QAOQO,QAPR,eAQQC,QARR,CAQmBC,IAAI,CAACC,KAAL,CAAWH,QAAQ,CAACC,QAApB,CARnB,CASQG,UATR,CASqBH,QAAQ,CAACG,UAT9B,CAWWC,CAXX,CAWe,CAXf,aAWkBA,CAAC,CAAGD,UAAU,CAACE,MAXjC,2CAaUC,IAbV,CAaiB,EAbjB,CAcUC,IAdV,CAciB,EAdjB,CAeMA,IAAI,CAAGJ,UAAU,CAACC,CAAD,CAAV,CAAcI,KAArB,CACAF,IAAI,CAAGH,UAAU,CAACC,CAAD,CAAV,CAAcK,IAArB,CACIC,QAjBV,CAiBqBJ,IAAI,CAACK,OAAL,CAAa,SAAb,CAAwB,EAAxB,CAjBrB,CAkBYC,GAlBZ,6CAkBuDF,QAlBvD,yBAmB6BG,CAAAA,KAAK,CAACD,GAAD,CAAL,CAAWE,IAAX,CAAgB,SAAAC,CAAC,QAAIA,CAAAA,CAAC,CAACC,IAAF,EAAJ,EAAjB,CAnB7B,SAmBYC,QAnBZ,eAoBUC,YApBV,CAoByBC,OAAO,CAAC,kBAAD,CApBhC,CAqBMD,YAAY,CAACD,QAAD,CAAWV,IAAI,CAAG,MAAlB,CAAZ,CArBN,iFAuBMa,OAAO,CAACC,GAAR,CAAY,MAAZ,EACAhC,UAAU,CAAC,KAAD,CAAV,CACAiC,YAAY,GAzBlB,2CA4BIF,OAAO,CAACC,GAAR,CAAY,SAAZ,EACAhC,UAAU,CAAC,KAAD,CAAV,CACAL,aAAa,CAAC,KAAD,CAAb,CACAuC,YAAY,GA/BhB,QAWyCnB,CAAC,EAX1C,4FARoB,mDA2CpB,QAASmB,CAAAA,YAAT,EAAwB,CACtB,GAAIC,CAAAA,WAAW,CAAG,CAAlB,CACA,GAAMC,CAAAA,KAAK,CAAG/D,KAAK,CAACgE,OAAN,CAAc,CAC1BC,KAAK,CAAE,UADmB,CAE1BC,OAAO,+BAFmB,CAAd,CAAd,CAIAC,UAAU,CAAC,UAAM,CACfJ,KAAK,CAACK,OAAN,GACD,CAFS,CAEPN,WAAW,CAAG,IAFP,CAAV,CAGD,CAED,QAASF,CAAAA,YAAT,EAAwB,CACtB,GAAIE,CAAAA,WAAW,CAAG,CAAlB,CACA,GAAMC,CAAAA,KAAK,CAAG/D,KAAK,CAACqE,KAAN,CAAY,CACxBJ,KAAK,CAAE,QADiB,CAExBC,OAAO,kBAFiB,CAAZ,CAAd,CAIAC,UAAU,CAAC,UAAM,CACfJ,KAAK,CAACK,OAAN,GACD,CAFS,CAEPN,WAAW,CAAG,IAFP,CAAV,CAGD,CAED,GAAMQ,CAAAA,uBAAuB,CAAG,QAA1BA,CAAAA,uBAA0B,CAACzC,GAAD,CAAS,CACvCL,iBAAiB,CAACK,GAAD,CAAjB,CACAP,aAAa,CAAC,IAAD,CAAb,CACD,CAHD,CAKA,mBACE,wCACE,aAAK,KAAK,CAAEb,MAAM,CAACC,IAAnB,WACG,CAACS,YAAD,eACC,wCACE,KAAC,KAAD,EACE,OAAO,CAAC,8FADV,CAEE,IAAI,CAAC,SAFP,EADF,cAKE,YAAK,KAAK,CAAE,CAAEoD,YAAY,CAAE,MAAhB,CAAZ,EALF,GAFJ,CAUGrD,UAAU,EACTA,UAAU,CAACsD,GAAX,CAAe,SAAC3C,GAAD,CAAM4C,KAAN,qBACb,KAAC,IAAD,EACE,SAAS,KADX,CAEE,OAAO,CAAE,cACP,KAAC,OAAD,EAAS,KAAK,CAAC,8BAAf,uBACE,KAAC,kBAAD,EACE,OAAO,CAAE,yBACPC,CAAAA,MAAM,CAACC,IAAP,WACKpE,WAAW,CAACa,OAAD,CADhB,kBACkCS,GAAG,CAACI,aADtC,EAEE,QAFF,CADO,EADX,EADF,EADO,cAWP,KAAC,OAAD,EAAS,KAAK,CAAC,8BAAf,uBACE,KAAC,gBAAD,EAAkB,OAAO,CAAE,yBAAMqC,CAAAA,uBAAuB,CAACzC,GAAD,CAA7B,EAA3B,EADF,EAXO,CAFX,CAiBE,KAAK,CAAE,CAAE+C,KAAK,CAAE,GAAT,CAAcC,MAAM,CAAE,mBAAtB,CAjBT,CAkBE,KAAK,cACH,KAAC,KAAD,EACE,OAAO,CAAE,KADX,CAEE,GAAG,CAAE,CAAAhD,GAAG,OAAH,EAAAA,GAAG,SAAH,QAAAA,GAAG,CAAEiD,KAAL,GAAc,OAFrB,CAGE,QAAQ,CAAC,gqGAHX,CAIE,GAAG,CAAC,EAJN,CAKE,KAAK,CAAE,CAAEC,MAAM,CAAE,OAAV,CALT,EAnBJ,uBA6BE,KAAC,IAAD,EAAM,KAAK,CAAElD,GAAG,CAACgB,IAAjB,CAAuB,WAAW,CAAEhB,GAAG,CAACmD,aAAxC,EA7BF,EA2BOP,KA3BP,CADa,EAAf,CAXJ,GADF,cA8CI,MAAC,KAAD,EACE,KAAK,oBAAclD,cAAd,SAAcA,cAAd,iBAAcA,cAAc,CAAEsB,IAA9B,cAAuCtB,cAAvC,SAAuCA,cAAvC,iBAAuCA,cAAc,CAAEW,QAAvD,UADP,CAEE,OAAO,CAAEb,OAFX,CAGE,MAAM,CAAC,gBAHT,CAIE,IAAI,CAAE,sBAAMO,CAAAA,gBAAgB,CAACL,cAAD,CAAtB,EAJR,CAKE,QAAQ,CAAE,0BAAMD,CAAAA,aAAa,CAAC,KAAD,CAAnB,EALZ,wBAOE,2FAPF,cAQI,KAAC,IAAD,EAAM,QAAQ,CAAEI,OAAhB,uBACA,YAAK,GAAG,CAAC,KAAT,CACE,GAAG,WAAKH,cAAL,SAAKA,cAAL,iBAAKA,cAAc,CAAEuD,KAArB,CADL,CAEE,KAAK,CAAE,CACLF,KAAK,CAAE,OADF,CAEL7D,MAAM,CAAE,MAFH,CAGLkE,YAAY,CAAE,MAHT,CAILC,SAAS,CAAE,MAJN,CAKLX,YAAY,CAAE,MALT,CAFT,EADA,EARJ,GA9CJ,GADF,CAsED,CAED,cAAerD,CAAAA,UAAf","sourcesContent":["import React, { useState } from \"react\";\nimport { useMoralisWeb3Api } from \"react-moralis\";\nimport { Card, Image, Tooltip, Modal, Alert, Spin } from \"antd\"; // Input, Button\nimport { useNFTBalance } from \"hooks/useNFTBalance\";\nimport { FileSearchOutlined, DownloadOutlined } from \"@ant-design/icons\";\nimport { useMoralisDapp } from \"providers/MoralisDappProvider/MoralisDappProvider\";\nimport { getExplorer } from \"helpers/networks\";\n\nconst { Meta } = Card;\n\nconst styles = {\n  NFTs: {\n    display: \"flex\",\n    flexWrap: \"wrap\",\n    WebkitBoxPack: \"start\",\n    justifyContent: \"flex-start\",\n    margin: \"0 auto\",\n    maxWidth: \"1000px\",\n    gap: \"10px\",\n  },\n};\n\nfunction NFTBalance() {\n  const { NFTBalance, fetchSuccess } = useNFTBalance();\n  const { chainId } = useMoralisDapp();\n  const [visible, setVisibility] = useState(false);\n  const [nftToGrabFiles, setNftToGrabFiles] = useState(null);\n  const Web3Api = useMoralisWeb3Api();\n  const [loading, setLoading] = useState(false);\n\n  async function fetchNFTMetadata(nft) {\n    setLoading(true);\n    const options = {\n      chain: chainId,\n      address: nft.token_address,\n      token_id: nft.token_id\n    };\n    const metaData = await Web3Api.token.getTokenIdMetadata(options)\n    const metadata = JSON.parse(metaData.metadata);    \n    const attributes = metadata.attributes\n\n    for (let i = 0; i < attributes.length; i++) {\n      try {\n        let hash = '';\n        let name = '';\n        name = attributes[i].value\n        hash = attributes[i].file\n        let ipfsHash = hash.replace(\"ipfs://\", \"\")\n        const url = `https://ipfs.moralis.io:2053/ipfs/${ipfsHash}`\n        const response = await fetch(url).then(r => r.blob())\n        var fileDownload = require('js-file-download');\n        fileDownload(response, name + \".stl\")\n      } catch (e) {\n        console.log('fail')\n        setLoading(false);\n        failDownload();\n        break;\n      }\n      console.log('success');\n      setLoading(false);\n      setVisibility(false);\n      succDownload();\n    }\n  }\n\n  function succDownload() {\n    let secondsToGo = 5;\n    const modal = Modal.success({\n      title: \"Success!\",\n      content: `Files succesfully downloaded`,\n    });\n    setTimeout(() => {\n      modal.destroy();\n    }, secondsToGo * 1000);\n  }\n\n  function failDownload() {\n    let secondsToGo = 5;\n    const modal = Modal.error({\n      title: \"Error!\",\n      content: `No files found!`,\n    });\n    setTimeout(() => {\n      modal.destroy();\n    }, secondsToGo * 1000);\n  }\n\n  const handleDownloadFileClick = (nft) => {\n    setNftToGrabFiles(nft);\n    setVisibility(true);\n  }\n\n  return (\n    <>\n      <div style={styles.NFTs}>\n        {!fetchSuccess && (\n          <>\n            <Alert\n              message=\"Unable to fetch all NFT metadata... We are searching for a solution, please try again later!\"\n              type=\"warning\"\n            />\n            <div style={{ marginBottom: \"10px\" }}></div>\n          </>\n        )} \n        {NFTBalance &&\n          NFTBalance.map((nft, index) => (\n            <Card\n              hoverable\n              actions={[\n                <Tooltip title=\"View Token on Block Explorer\">\n                  <FileSearchOutlined\n                    onClick={() =>\n                      window.open(\n                        `${getExplorer(chainId)}token/${nft.token_address}`,\n                        \"_blank\"\n                      )\n                    }\n                  />\n                </Tooltip>,\n                <Tooltip title=\"Download Files, if available\">\n                  <DownloadOutlined onClick={() => handleDownloadFileClick(nft)} />\n                </Tooltip>,\n              ]}\n              style={{ width: 240, border: \"2px solid #e7eaf3\" }}\n              cover={\n                <Image\n                  preview={false}\n                  src={nft?.image || \"error\"}\n                  fallback=\"data:image/png;base64,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\"\n                  alt=\"\"\n                  style={{ height: \"240px\" }}\n                />\n              }\n              key={index}\n            >\n              <Meta title={nft.name} description={nft.contract_type}/>\n            </Card>\n          ))}\n      </div>\n        <Modal\n          title={`Download ${nftToGrabFiles?.name} #${nftToGrabFiles?.token_id} Files`}\n          visible={visible}\n          okText=\"Download Files\"\n          onOk={() => fetchNFTMetadata(nftToGrabFiles)}\n          onCancel={() => setVisibility(false)}\n        >\n          <p>Click Download Files to download the 3d printer files, if available!</p>\n            <Spin spinning={loading}>\n            <img alt=\"NFT\"\n              src={`${nftToGrabFiles?.image}`}\n              style={{\n                width: \"250px\",\n                margin: \"auto\",\n                borderRadius: \"10px\",\n                marginTop: \"15px\",\n                marginBottom: \"15px\",\n              }}\n            />\n            </Spin>\n        </Modal>\n    </>\n  );\n}\n\nexport default NFTBalance;"]},"metadata":{},"sourceType":"module"}